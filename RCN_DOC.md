


### I. プログラムの概要  

#### A. はじめに  
このプログラム群は、64ビットワードの CRAY または CDC CYBER 205 コンピュータ上で動作する FORTRAN 77 プログラムであり、自己無撞着場（self-consistent-field）計算による原子のラジアル波動関数、および原子のエネルギー準位やスペクトル計算に必要な各種ラジアル積分を求めるために使用されます。RCN および RCN2 は以下のコーディング特性により、VAX、IBM RISC、SUN、Macintosh などの 32 ビットワードコンピュータにも容易に適応可能です。  

1. **IMPLICIT REAL*8 (A-H,O-Z) 文** をすべてのプログラムユニットに含めており、浮動小数点変数が 32 ビットコンピュータでは自動的に倍精度になるようになっています。（64 ビットマシンでは必要に応じてコメントアウト可能です。）  
2. 組み込み関数には **汎用名** を使用し、引数には数値ではなく、`HALF=0.5` や `TWO=2.0` などの変数を定義することで、32 ビットマシンでも自動的に倍精度変換が行われます。  
3. **共通ブロック (COMMON)** の名前はすべてのサブルーチンで同じ長さを持つように設計されています。整数型のストレージスペースが浮動小数点変数の前にある場合、それらは常に偶数個となっています。  

本プログラム群は、以下の 4 つの組み合わせで連続して実行できます。  

- **RCN**  
- **RCN/RCN2**  
- **RCN/HF**  
- **RCN/HF/RCN2**  

主な入力情報は常に RCN に与えられ、それぞれのプログラムは自動的に次のプログラムに必要な情報を提供します。プログラムの詳細については後述しますが、ここでは各プログラムの基本的な目的を概説します。  

**注意:** RCN Mod36 には、依然として HF への情報を受け渡す機能が含まれています。しかし、1981 年以前のバージョンとは異なり、RCN 自体で **ハートリー・フォック波動関数** を計算できるようになりました。そのため、プログラム HF はもはや必要なく、配布もされていません。ただし、HF の **対数ラジアルメッシュ** を使用した波動関数を必要とする場合には、RCN にそのオプションが残されています。


### B. プログラム RCN Mod36  

プログラム **RCN** は、球対称化された原子に対して、ハートリー・フォック法の以下の 4 つの同次微分方程式近似のいずれかを用いて、単一構成の **ラジアル波動関数** $\( P_{nl}(r) \)$ を計算します。  

1. **ハートリー (H)**  
2. **ハートリー・フォック・スレーター (HFS/HFSL)**  
   - スレーターの近似交換項の係数を任意に設定可能  
   - **HFS**: ラター (Latter) のテールカットオフなし  
   - **HFSL**: ラターのテールカットオフあり  
3. **ハートリー＋統計的交換 (HX)**  
4. **ハートリー・スレーター (HS)**  
5. **真のハートリー・フォック (HF)**  
   - 球対称化された原子の中心重心エネルギー (center-of-gravity energy) を計算  
   - 特定の **LS 項** のエネルギーを求める **LSD-HF** 法 (ただし、その **LS** 値を持つ項が 1 つのみ存在する場合に限る)  

通常は、**HX 法** または **中心重心 HF 法** のみが使用されます。  

さらに、ラジアル波動関数に加えて、各構成について以下のような **ラジアル積分** も計算されます。  

- $\langle r^m \rangle$ （電荷分布モーメント）  
- $F_{k} ,  G_{k}$ （スレーター積分）  
- $\zeta$ （スピン・軌道相互作用積分）  
- 原子の全エネルギー **$E_{\text{av}}$**（相対論的補正および相関エネルギー補正を含む）  

また、以下の相対論的補正を考慮することも可能です。  

- 微分方程式のポテンシャル関数に相対論的項を追加（HXR または HFR）  
  - これにより、**相対論的補正を含むラジアル波動関数** を得る  
  - 特に重い原子（**Z > 50 の外軌道、Z > 20 の内軌道**）で重要  
- 相関項をポテンシャル関数に追加し、ポテンシャルをより負にすることで、**負イオンの束縛状態** を改善  

また、計算したラジアル波動関数を **RCN2** や **HF8** の入力として使用するオプションも提供されています。


### C. プログラム HF Mod8  

プログラム **HF8** は、単一構成の **ハートリー・フォック (Hartree-Fock) ラジアル波動関数** を計算します。この計算は、以下のいずれかの方法で行われます。  

- **構成の中心重心エネルギー (center-of-gravity energy) に対応する波動関数**  
- **特定の LS 項のエネルギーに対応する波動関数**（ただし、その LS 値を持つ項が 1 つのみ存在する場合に限る）  

また、**RCN** と同様に、以下の計算も実行されます。  

- **ラジアル積分 $(\(\langle r^m \rangle, F_k, G_k, \zeta\))$**  
- **原子の全エネルギー $\(E_{\text{av}}\)$**  
- **相対論的補正および相関補正**  

**入力データ:**  
- **RCN** からの出力をそのまま使用  
- 例外として、**制御カード (universal control card)** のみが外部入力  

**出力データ:**  
- **RCN2** の入力用の波動関数を提供  

さらに、必要に応じて **HF 方程式に相対論的補正項を追加 (HFR)** することも可能です。  

### HF8 の有用性について  
- **RCN** でも **HF** または **HFR** 波動関数を計算できるため、**HF8 の実用性は低い**。  
- ただし、**HF8 の利点** として、以下の点が挙げられる。  
  - **異なる主量子数 $\(n\)$ を持つが、同じ方位量子数 $\(l\)$ を持つラジアル波動関数間の直交性を保証**  
    - これは、**非対角ラグランジュ係数 (off-diagonal Lagrangian parameters) の考慮** によるもの  
    - ただし、これは 2 つの軌道の **占有数 (occupation numbers) が異なる場合** に限る  
- **HF8 の制約:**  
  - **一電子構成** (one-electron configurations) を扱えない  
  - **単一副殻構成 $\( nlw \)$ を扱えない**  
  - **非束縛状態 (連続関数, continuum functions) を計算できない**


### D. プログラム RCN2  

プログラム **RCN2** は、以下のいずれかのプログラムから得られた **ラジアル波動関数** を入力として受け取ります。  

- **RCN**  
- **HF**  

この波動関数は、**1つ以上の異なる構成** を持つ **1つ以上の原子またはイオン** に対応します。RCN2 は、各原子に対して **2構成間のラジアル積分** を計算します。  

### 計算されるラジアル積分  
- **重なり積分 (overlap integrals)**  
$\langle P_{nl} | P_{n'l'} \rangle$  
- **相互作用クーロン積分 (configuration-interaction Coulomb integrals)**
  $R_k$  
- **スピン-軌道積分 (spin-orbit integrals)**  
  $\zeta_{nl n'l'}$  
- **ラジアル電気双極子 (electric-dipole) および 電気四重極子 (electric-quadrupole) 積分**  

RCN2 の最も一般的な用途では、**原子のエネルギーレベルとスペクトルの計算に必要なすべての量を自動的に計算** します。その後、この情報を **プログラム RCG** の入力形式に適合したファイルに書き込みます。RCG はエネルギーレベルやスペクトルの計算を実行するプログラムです。  

### 平面波ボルン近似 (Plane-Wave Born Approximation) における RCN2 の役割  
**RCG における平面波ボルン近似 (Plane-Wave Born Calculations) を利用する場合、**  
- **RCN2 ではラジアル多重極積分 (radial multipole integrals) の計算が、球ベッセル関数 (spherical Bessel functions) のラジアル積分の計算に置き換えられます。**  

### 関連理論の参照  
本プログラム群の理論的背景については、以下の文献を参照してください。  

**Robert D. Cowan,** *The Theory of Atomic Structure and Spectra* (University of California Press, Berkeley, 1981)  
- **第7章**  
- **第8-1節, 第16-1節, 第18-13節**  

以降、この文献を **TASS** と略記します。


### E. 計算時間  

CRAY-1 コンピュータでの **RCN** および **HF** の計算時間の概算を以下に示します。  
- **CRAY-YMP** では、計算時間は **約 2～3 倍短縮** される。  
- **CYBER 205** では、以下の表とほぼ同じ計算時間になる。  
- **CDC 7600, IBM 360/95, IBM 370/195** では、**約 3 倍の時間がかかる**。  
- **CDC 6600, SUN Sparcstation** では、**約 10 倍の時間がかかる**。  
- **Macintosh Centris 650** では、**約 15 倍の時間がかかる**。  
- **VAX 8200, CDC 6500, IBM 7094** では、**約 40 倍の時間がかかる**。  
- **VAX 11/780** では、**約 100 倍の時間がかかる**。  

#### **RCN および HF8 の計算時間 (秒)**
| 構成 (Config.)  | HX  | HXR | HF  | HFR | HX + HF | HXR + HFR |
|--------------|----|----|----|----|------|--------|
| Ar I  3p⁶    |  2 |  2 |  1 |  1 | 1 + 1 | 1 + 1  |
| Kr I  4p⁶    |  3 |  3 |  3 |  3 | 2 + 2 | 1 + 3  |
| Xe I  5p⁶    |  4 |  4 |    |  5 | 3 + 4 | 1 + 5  |
| Dy I  4f¹⁰6s² |  6 |  7 |    | 10 | 4 + 6 | 2 + 8  |
| Rn I  6p⁶    |  6 |  7 |    | 13 | 4 + 9 | 2 + 11 |
| U I  5f³6d7s² |  7 |  9 |    | 17 | 5 + 18 | 3 + 30 |

> **注記:**  
> a) **HX + HF** の時間は **SCF 計算 $(TOLEND = \(5 \times 10^{-8}\))$ + ZETA1** の合計時間。  
> b) **HXR + HFR** の時間は **SCF 計算 $(TOLEND = \(5 \times 10^{-2}\))$ のみ**。  

#### **RCN2 の計算時間について**  
**RCN2 の計算時間は通常 RCN または HF の時間のごく一部にすぎません。**  
ただし、**TAPE2N 入力ファイル** に多くの構成（**20 以上** など）が含まれている場合、  
特に **シリアル番号の大きい構成** を計算する際、**読み取りや巻き戻し時間が長くなる** ことがあります。  
特に **テープユニット** にファイルが保存されている場合、待機時間が不快なほど長くなることがあります。



**II. プログラム RCN36**

**A. プログラム概要**

本プログラムは FORTRAN 77 によって記述されたものであり、球対称化された原子における動径波動関数 $P_{nl}(r)$ を計算するものである。これらの波動関数は、電子配置

$\(n_1l_1)w_1 (n_2l_2)w_2 ... (n_ql_q)w_q             (1\)$

に対応する重心エネルギー $E_{av}$ に基づいて求められる。

これらの動径波動関数から、クーロン積分 $F_k$ および $G_k$、スピン・軌道相互作用積分 $\zeta_{nl}$ が計算される。また、運動エネルギーおよび電子-原子核エネルギーを与えるために必要なラジアル積分、さらには一電子束縛エネルギーおよび全電子束縛エネルギー $E_{av}$ に対する粗い相対論的補正および相関補正も計算される。

このプログラムは、当初（1964年1月）、Herman および Skillman によって記述された SHARE プログラム 1417（ML HFSS）に基づいていた（Atomic Structure Calculations, Prentice-Hall, 1963）。この文献は、RCN におけるラジアル積分メッシュおよび基本的数値手法の説明として参照されうる。しかしながら、サブルーチン CROSYM および SCHEQ の一部を除いて、元のプログラムはほとんど原形をとどめていない（記法も SNL(M,I) および SNLO(I) から PNL(I,M) および PNLO(I) に変更されており、NNLZ の定義も 100n+10l+定数 から 100n+l に再定義されている）。

現在でも、Herman および Skillman によって使用された Hartree-Fock-Slater 近似による計算を行うオプションが存在し、これには Latter による一電子ポテンシャルのテールカットオフの有無、Slater の元の交換係数 3/2 または Kohn と Sham による修正値 1（あるいは任意の他の値）の使用が含まれる。しかしながら、これらの近似はいずれも満足のいくものとは見なされていない。はるかに優れた選択肢として、本書 TASS で記述された Hartree＋統計的交換（HX）近似を利用することができ、理論的背景については同書を参照されたい。さらに他の選択肢としては、Lindgren および Rosen による HS 近似（Int. J. Quant. Chem. S5, 411 (1971); Phys. Scripta 6, 109 (1972)、または TASS を参照）および完全な Hartree-Fock 計算がある。Hartree-Fock が推奨される選択肢である。

通常、すべての動径方向関数は自己無撞着性が得られるまで反復計算される。ただし、最初の構成以外では、任意の数の内側軌道を固定（凍結コア近似）することが可能である（変数 IBB1 に関する議論および II-J および II-K 節を参照）。



プログラムはすべて FORTRAN 77 で記述されており、メインプログラムと約30のサブプログラムで構成されています。  
RCN36 はメインプログラムであり、通常の計算が実行されるか、あるいはダイエレクトロニック再結合に関連する計算が実行されるかを主に判断します。  
RCN はメインサブルーチンです。これは（通常の計算における）すべての入力と一部の出力を処理し、自己無撞着場反復を制御し、詳細な計算の一部を行います。  
ANALYZ および SETCFG は、構成定義入力を解釈し、1電子固有値の初期値を推定します。  
DIEL および ANALYZ1 は、ダイエレクトロニック再結合の計算を設定する際の手作業を削減するために使用されるサブルーチンです。詳細はセクション II-L に記載されています。  
SCHEQ は 1電子動径波動方程式を積分し、1電子固有値 $E = EE(M)$ の反復を制御して、境界条件 $r = 0$ および $\infty$ を満たす動径関数 $P_{nl}(r) \cdot r R_{nl}(r) = PNLO(I) = PNL(I,M)$ を与えます。  
また、束縛電子$\（E < 0\）$または自由電子$\（E > 0\）$のいずれに対しても関数を適切に正規化します$\（E = 0$ の場合は扱えません）。  
自由電子に対する正規化は、積分メッシュが粗すぎるため、$E > 0.1$ リュードベリのときには不正確になる可能性があります。これは $EMX/10 < E < EMX$ の範囲内であり、かつ $PNL$, $R$ その他の変数に対して非常に大きな次元が使用されている場合に限り、問題を回避できます（連続スペクトル波動関数の計算についてはセクション II-G の注記を参照）。  
適切な非ゼロの小さな $EMX$ の値を用いることで、$n \approx 15 \text{〜} 40$ の大きな $n$ に対する $P_{nl}$ の計算も可能になります。これは、$EMX = 0$ のときに用いられる 641 点のメッシュではなく、1801 点の完全なメッシュを利用することによって達成されます。ただし、$EMX$ の値が大きすぎたり、$n$ が大きすぎたりすると、1801 点のメッシュでも半径が十分に大きくならず、収束に失敗することになります。

OUTPT は、出力の大部分（POWER、ZETA1、SLI1 を呼び出して）および波動関数の出力（ディスクファイル 2 または HFWRTP を介したディスクファイル 7）を処理し、それぞれ RCN2 または HF8 への入力を提供します。

SUBCOR は、指定された電子密度に対する修正自由電子相関エネルギーを計算します。

CROSYM は、以下を与えるための連立一次方程式系を解きます：

$AZ=\left[ \frac{P_{nl}(r)}{r^{l+1}} \right]_{r = 0}\tag{2}$

POWER は各軌道について $-3 \leq m \leq 6 \ (m \ne 5)$ における $\langle r^m \rangle$ の値を計算します。

ZETA1 は中心ポテンシャル公式に基づいてスピン・軌道相互作用パラメータ $z_{nl}$ を計算します：

$$
z_{nl} = \int_0^{\infty} \left[ P_{nl}^2(r) \cdot \left( \frac{1}{r} \frac{dV}{dr} \right) \right] dr
\tag{3}
$$

加えて、Blume-Watson 法（[Proc. Roy. Soc. (London) A270, 127 (1962); A271, 565 (1963)]）でも計算されます。この方法の方がはるかに正確な値を与えるため、実際に使用されるのはこの値です。  
また、1電子の運動エネルギーと電子-原子核ポテンシャルエネルギーの和 $I_{nl}$、および相対論的な質量-速度補正とダーウィン項も計算・出力されます（実際には $I_{nl}$ は RCN3S 内で計算され、ZETA1 では出力のみ行われます）。

SLI1 はすべてのスレーター積分 $F_k$ および $G_k$（リュードベリ単位および cm$^{-1}$ 単位）を計算・出力します。さらにオーバーラップ積分も計算し、RCN3S を呼び出します。

RCN3S はオーバーラップ積分を出力し、$F_k$, $G_k$（およびサブルーチン S3J0SQ の助けを借りて）から電子対間のクーロン相互作用エネルギーを計算して出力します。  
続いて相関エネルギー補正を計算し、ZETA1 から得られた $I_{nl}$ を用いて 1電子の束縛エネルギーおよび原子の全束縛エネルギーを計算・出力します（式については TASS を参照）。  
また、原子エネルギー準位計算に必要な単一構成パラメータ値 $E_{av}, F_k(ii), z_i, F_k(ij), G_k(ij)$ も出力されます。  
全束縛エネルギー $E_{av}$ はリュードベリ単位で、その他のパラメータ値はすべて kK（$=1000$ cm$^{-1}$ 単位）で出力されます。

